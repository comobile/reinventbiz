/*
 * easyXDM
 * http://easyxdm.net/
 * Copyright(c) 2009-2011, Ã˜yvind Sean Kinsey, oyvind@kinsey.no.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
(function(j,C,L,g,G,d){var B=this;var J=Math.floor(Math.random()*10000);var M=Function.prototype;var m=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/;var n=/[\-\w]+\/\.\.\//;var b=/([^:])\/\//g;var e="";var K={};var i=j.easyXDM;var q="easyXDM_";var a;var U=false;function Y(u,w){var v=typeof u[w];return v=="function"||(!!(v=="object"&&u[w]))||v=="unknown"}function Q(u,v){return !!(typeof (u[v])=="object"&&u[v])}function N(u){return Object.prototype.toString.call(u)==="[object Array]"}function s(v){try{var u=new ActiveXObject(v);u=null;return true}catch(w){return false}}var R,T;if(Y(j,"addEventListener")){R=function(w,u,v){w.addEventListener(u,v,false)};T=function(w,u,v){w.removeEventListener(u,v,false)}}else{if(Y(j,"attachEvent")){R=function(u,w,v){u.attachEvent("on"+w,v)};T=function(u,w,v){u.detachEvent("on"+w,v)}}else{throw new Error("Browser not supported")}}var t=false,f=[],h;if("readyState" in C){h=C.readyState;t=h=="complete"||(~navigator.userAgent.indexOf("AppleWebKit/")&&(h=="loaded"||h=="interactive"))}else{t=!!C.body}function O(){O=M;t=true;for(var u=0;u<f.length;u++){f[u]()}f.length=0}if(!t){if(Y(j,"addEventListener")){R(C,"DOMContentLoaded",O)}else{R(C,"readystatechange",function(){if(C.readyState=="complete"){O()}});if(C.documentElement.doScroll&&j===top){(function E(){if(t){return }try{C.documentElement.doScroll("left")}catch(u){g(E,1);return }O()}())}}R(j,"load",O)}function c(v,u){if(t){v.call(u);return }f.push(function(){v.call(u)})}function I(){var w=parent;if(e!==""){for(var u=0,v=e.split(".");u<v.length;u++){w=w[v[u]]}}return w.easyXDM}function D(u){j.easyXDM=i;e=u;if(e){q="easyXDM_"+e.replace(".","_")+"_"}return K}function V(u){return u.match(m)[3]}function F(w){var u=w.match(m);var x=u[2],y=u[3],v=u[4]||"";if((x=="http:"&&v==":80")||(x=="https:"&&v==":443")){v=""}return x+"//"+y+v}function X(u){u=u.replace(b,"$1/");if(!u.match(/^(http||https):\/\//)){var v=(u.substring(0,1)==="/")?"":L.pathname;if(v.substring(v.length-1)!=="/"){v=v.substring(0,v.lastIndexOf("/")+1)}u=L.protocol+"//"+L.host+v+u}while(n.test(u)){u=u.replace(n,"")}return u}function l(u,x){var z="",w=u.indexOf("#");if(w!==-1){z=u.substring(w);u=u.substring(0,w)}var y=[];for(var v in x){if(x.hasOwnProperty(v)){y.push(v+"="+d(x[v]))}}return u+(U?"#":(u.indexOf("?")==-1?"?":"&"))+y.join("&")+z}var o=(function(u){u=u.substring(1).split("&");var w={},x,v=u.length;while(v--){x=u[v].split("=");w[x[0]]=G(x[1])}return w}(/xdm_e=/.test(L.search)?L.search:L.hash));function P(u){return typeof u==="undefined"}function k(){var v={};var w={a:[1,2,3]},u='{"a":[1,2,3]}';if(typeof JSON!="undefined"&&typeof JSON.stringify==="function"&&JSON.stringify(w).replace((/\s/g),"")===u){return JSON}if(Object.toJSON){if(Object.toJSON(w).replace((/\s/g),"")===u){v.stringify=Object.toJSON}}if(typeof String.prototype.evalJSON==="function"){w=u.evalJSON();if(w.a&&w.a.length===3&&w.a[2]===3){v.parse=function(x){return x.evalJSON()}}}if(v.stringify&&v.parse){k=function(){return v};return v}return null}function p(u,v,w){var y;for(var x in v){if(v.hasOwnProperty(x)){if(x in u){y=v[x];if(typeof y==="object"){p(u[x],y,w)}else{if(!w){u[x]=v[x]}}}else{u[x]=v[x]}}}return u}function A(){var u=C.createElement("iframe");u.name=q+"TEST";p(u.style,{position:"absolute",left:"-2000px",top:"0px"});C.body.appendChild(u);a=!(u.contentWindow===j.frames[u.name]);C.body.removeChild(u)}function W(u){if(P(a)){A()}var w;if(a){w=C.createElement("<iframe name='"+u.props.name+"' frameborder='0' allowtransparency='false' tabindex='-1', role='presentation' scrolling='no' />")}else{w=C.createElement("IFRAME");w.name=u.props.name;w.setAttribute("frameborder","0");w.setAttribute("allowtransparency","false");w.setAttribute("tabindex","-1");w.setAttribute("role","presentation");w.setAttribute("scrolling","no")}w.id=w.name=u.props.name;delete u.props.name;if(u.onLoad){R(w,"load",u.onLoad)}if(typeof u.container=="string"){u.container=C.getElementById(u.container)}if(!u.container){w.style.position="absolute";w.style.top="-2000px";u.container=C.body}var v=u.props.src;delete u.props.src;p(w,u.props);w.border=w.frameBorder=0;u.container.appendChild(w);w.src=v;u.props.src=v;return w}function r(x,w){if(typeof x=="string"){x=[x]}var v,u=x.length;while(u--){v=x[u];v=new RegExp(v.substr(0,1)=="^"?v:("^"+v.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"));if(v.test(w)){return true}}return false}function H(w){var AB=w.protocol,v;w.isHost=w.isHost||P(o.xdm_p);U=w.hash||false;if(!w.props){w.props={}}if(!w.isHost){w.channel=o.xdm_c;w.secret=o.xdm_s;w.remote=o.xdm_e;AB=o.xdm_p;if(w.acl&&!r(w.acl,w.remote)){throw new Error("Access denied for "+w.remote)}}else{w.remote=X(w.remote);w.channel=w.channel||"default"+J++;w.secret=Math.random().toString(16).substring(2);if(P(AB)){if(F(L.href)==F(w.remote)){AB="4"}else{if(Y(j,"postMessage")||Y(C,"postMessage")){AB="1"}else{if(Y(j,"ActiveXObject")&&s("ShockwaveFlash.ShockwaveFlash")){AB="6"}else{if(navigator.product==="Gecko"&&"frameElement" in j&&navigator.userAgent.indexOf("WebKit")==-1){AB="5"}else{if(w.remoteHelper){w.remoteHelper=X(w.remoteHelper);AB="2"}else{AB="0"}}}}}}}switch(AB){case"0":p(w,{interval:100,delay:2000,useResize:true,useParent:false,usePolling:false},true);if(w.isHost){if(!w.local){var z=L.protocol+"//"+L.host,u=C.body.getElementsByTagName("img"),AA;var x=u.length;while(x--){AA=u[x];if(AA.src.substring(0,z.length)===z){w.local=AA.src;break}}if(!w.local){w.local=j}}var y={xdm_c:w.channel,xdm_p:0};if(w.local===j){w.usePolling=true;w.useParent=true;w.local=L.protocol+"//"+L.host+L.pathname+L.search;y.xdm_e=w.local;y.xdm_pa=1}else{y.xdm_e=X(w.local)}if(w.container){w.useResize=false;y.xdm_po=1}w.remote=l(w.remote,y)}else{p(w,{channel:o.xdm_c,remote:o.xdm_e,useParent:!P(o.xdm_pa),usePolling:!P(o.xdm_po),useResize:w.useParent?false:w.useResize})}v=[new K.stack.HashTransport(w),new K.stack.ReliableBehavior({}),new K.stack.QueueBehavior({encode:true,maxLength:4000-w.remote.length}),new K.stack.VerifyBehavior({initiate:w.isHost})];break;case"1":v=[new K.stack.PostMessageTransport(w)];break;case"2":v=[new K.stack.NameTransport(w),new K.stack.QueueBehavior(),new K.stack.VerifyBehavior({initiate:w.isHost})];break;case"3":v=[new K.stack.NixTransport(w)];break;case"4":v=[new K.stack.SameOriginTransport(w)];break;case"5":v=[new K.stack.FrameElementTransport(w)];break;case"6":if(!w.swf){w.swf="../../tools/easyxdm.swf"}v=[new K.stack.FlashTransport(w)];break}v.push(new K.stack.QueueBehavior({lazy:w.lazy,remove:true}));return v}function Z(x){var y,w={incoming:function(AA,z){this.up.incoming(AA,z)},outgoing:function(z,AA){this.down.outgoing(z,AA)},callback:function(z){this.up.callback(z)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var v=0,u=x.length;v<u;v++){y=x[v];p(y,w,true);if(v!==0){y.down=x[v-1]}if(v!==u-1){y.up=x[v+1]}}return y}function S(u){u.up.down=u.down;u.down.up=u.up;u.up=u.down=null}p(K,{version:"2.4.12.108",query:o,stack:{},apply:p,getJSONObject:k,whenReady:c,noConflict:D});K.DomHelper={on:R,un:T,requiresJSON:function(u){if(!Q(j,"JSON")){C.write('<script type="text/javascript" src="'+u+'"><\/script>')}}};(function(){var u={};K.Fn={set:function(v,w){u[v]=w},get:function(w,v){var x=u[w];if(v){delete u[w]}return x}}}());K.Socket=function(v){var u=Z(H(v).concat([{incoming:function(y,x){v.onMessage(y,x)},callback:function(x){if(v.onReady){v.onReady(x)}}}])),w=F(v.remote);this.origin=F(v.remote);this.destroy=function(){u.destroy()};this.postMessage=function(x){u.outgoing(x,w)};u.init()};K.Rpc=function(w,v){if(v.local){for(var y in v.local){if(v.local.hasOwnProperty(y)){var x=v.local[y];if(typeof x==="function"){v.local[y]={method:x}}}}}var u=Z(H(w).concat([new K.stack.RpcBehavior(this,v),{callback:function(z){if(w.onReady){w.onReady(z)}}}]));this.origin=F(w.remote);this.destroy=function(){u.destroy()};u.init()};K.stack.SameOriginTransport=function(v){var w,y,x,u;return(w={outgoing:function(AA,AB,z){x(AA);if(z){z()}},destroy:function(){if(y){y.parentNode.removeChild(y);y=null}},onDOMReady:function(){u=F(v.remote);if(v.isHost){p(v.props,{src:l(v.remote,{xdm_e:L.protocol+"//"+L.host+L.pathname,xdm_c:v.channel,xdm_p:4}),name:q+v.channel+"_provider"});y=W(v);K.Fn.set(v.channel,function(z){x=z;g(function(){w.up.callback(true)},0);return function(AA){w.up.incoming(AA,u)}})}else{x=I().Fn.get(v.channel,true)(function(z){w.up.incoming(z,u)});g(function(){w.up.callback(true)},0)}},init:function(){c(w.onDOMReady,w)}})};K.stack.FlashTransport=function(x){var z,u,y,AA,v,AC,AB=(e?e+".":"");function AD(AE){g(function(){z.up.incoming(AE,AA)},0)}function w(AI){var AE=x.swf;var AH="easyXDM_swf_"+Math.floor(Math.random()*10000);var AG=AB+'easyXDM.Fn.get("flash_'+AH+'_init")';K.Fn.set("flash_"+AH+"_init",function(){K.stack.FlashTransport.__swf=v=AC.firstChild;AI()});AC=C.createElement("div");p(AC.style,{height:"1px",width:"1px",postition:"abosolute",left:0,top:0});C.body.appendChild(AC);var AF="proto="+L.protocol+"&domain="+V(L.href)+"&init="+AG;AC.innerHTML="<object height='1' width='1' type='application/x-shockwave-flash' id='"+AH+"' data='"+AE+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+AE+"'></param><param name='flashvars' value='"+AF+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+AF+"' allowScriptAccess='always' wmode='transparent' src='"+AE+"' height='1' width='1'></embed></object>"}return(z={outgoing:function(AF,AG,AE){v.postMessage(x.channel,AF);if(AE){AE()}},destroy:function(){try{v.destroyChannel(x.channel)}catch(AE){}v=null;if(u){u.parentNode.removeChild(u);u=null}},onDOMReady:function(){AA=F(x.remote);v=K.stack.FlashTransport.__swf;var AE=function(){if(x.isHost){K.Fn.set("flash_"+x.channel+"_onMessage",function(AF){if(AF==x.channel+"-ready"){K.Fn.set("flash_"+x.channel+"_onMessage",AD);g(function(){z.up.callback(true)},0)}})}else{K.Fn.set("flash_"+x.channel+"_onMessage",AD)}v.createChannel(x.channel,x.remote,x.isHost,AB+'easyXDM.Fn.get("flash_'+x.channel+'_onMessage")',x.secret);if(x.isHost){p(x.props,{src:l(x.remote,{xdm_e:F(L.href),xdm_c:x.channel,xdm_s:x.secret,xdm_p:6}),name:q+x.channel+"_provider"});u=W(x)}else{v.postMessage(x.channel,x.channel+"-ready");g(function(){z.up.callback(true)},0)}};if(v){AE()}else{w(AE)}},init:function(){c(z.onDOMReady,z)}})};K.stack.PostMessageTransport=function(x){var z,AA,v,w;function u(AB){if(AB.origin){return F(AB.origin)}if(AB.uri){return F(AB.uri)}if(AB.domain){return L.protocol+"//"+AB.domain}throw"Unable to retrieve the origin of the event"}function y(AC){var AB=u(AC);if(AB==w&&AC.data.substring(0,x.channel.length+1)==x.channel+" "){z.up.incoming(AC.data.substring(x.channel.length+1),AB)}}return(z={outgoing:function(AC,AD,AB){v.postMessage(x.channel+" "+AC,AD||w);if(AB){AB()}},destroy:function(){T(j,"message",y);if(AA){v=null;AA.parentNode.removeChild(AA);AA=null}},onDOMReady:function(){w=F(x.remote);if(x.isHost){R(j,"message",function AB(AC){if(AC.data==x.channel+"-ready"){v=("postMessage" in AA.contentWindow)?AA.contentWindow:AA.contentWindow.document;T(j,"message",AB);R(j,"message",y);g(function(){z.up.callback(true)},0)}});p(x.props,{src:l(x.remote,{xdm_e:F(L.href),xdm_c:x.channel,xdm_p:1}),name:q+x.channel+"_provider"});AA=W(x)}else{R(j,"message",y);v=("postMessage" in j.parent)?j.parent:j.parent.document;v.postMessage(x.channel+"-ready",w);g(function(){z.up.callback(true)},0)}},init:function(){c(z.onDOMReady,z)}})};K.stack.FrameElementTransport=function(v){var w,y,x,u;return(w={outgoing:function(AA,AB,z){x.call(this,AA);if(z){z()}},destroy:function(){if(y){y.parentNode.removeChild(y);y=null}},onDOMReady:function(){u=F(v.remote);if(v.isHost){p(v.props,{src:l(v.remote,{xdm_e:F(L.href),xdm_c:v.channel,xdm_p:5}),name:q+v.channel+"_provider"});y=W(v);y.fn=function(z){delete y.fn;x=z;g(function(){w.up.callback(true)},0);return function(AA){w.up.incoming(AA,u)}}}else{if(C.referrer&&F(C.referrer)!=o.xdm_e){j.top.location=o.xdm_e}x=j.frameElement.fn(function(z){w.up.incoming(z,u)});w.up.callback(true)}},init:function(){c(w.onDOMReady,w)}})};K.stack.NixTransport=function(v){var x,z,y,u,w;return(x={outgoing:function(AB,AC,AA){y(AB);if(AA){AA()}},destroy:function(){w=null;if(z){z.parentNode.removeChild(z);z=null}},onDOMReady:function(){u=F(v.remote);if(v.isHost){try{if(!Y(j,"getNixProxy")){j.execScript("Class NixProxy\n    Private m_parent, m_child, m_Auth\n\n    Public Sub SetParent(obj, auth)\n        If isEmpty(m_Auth) Then m_Auth = auth\n        SET m_parent = obj\n    End Sub\n    Public Sub SetChild(obj)\n        SET m_child = obj\n        m_parent.ready()\n    End Sub\n\n    Public Sub SendToParent(data, auth)\n        If m_Auth = auth Then m_parent.send(CStr(data))\n    End Sub\n    Public Sub SendToChild(data, auth)\n        If m_Auth = auth Then m_child.send(CStr(data))\n    End Sub\nEnd Class\nFunction getNixProxy()\n    Set GetNixProxy = New NixProxy\nEnd Function\n","vbscript")}w=getNixProxy();w.SetParent({send:function(AC){x.up.incoming(AC,u)},ready:function(){g(function(){x.up.callback(true)},0)}},v.secret);y=function(AC){w.SendToChild(AC,v.secret)}}catch(AB){throw new Error("Could not set up VBScript NixProxy:"+AB.message)}p(v.props,{src:l(v.remote,{xdm_e:F(L.href),xdm_c:v.channel,xdm_s:v.secret,xdm_p:3}),name:q+v.channel+"_provider"});z=W(v);z.contentWindow.opener=w}else{if(C.referrer&&F(C.referrer)!=o.xdm_e){j.top.location=o.xdm_e}try{w=j.opener}catch(AA){throw new Error("Cannot access window.opener")}w.SetChild({send:function(AC){B.setTimeout(function(){x.up.incoming(AC,u)},0)}});y=function(AC){w.SendToParent(AC,v.secret)};g(function(){x.up.callback(true)},0)}},init:function(){c(x.onDOMReady,x)}})};K.stack.NameTransport=function(y){var z;var AB,AF,x,AD,AE,v,u;function AC(AI){var AH=y.remoteHelper+(AB?"#_3":"#_2")+y.channel;AF.contentWindow.sendMessage(AI,AH)}function AA(){if(AB){if(++AD===2||!AB){z.up.callback(true)}}else{AC("ready");z.up.callback(true)}}function AG(AH){z.up.incoming(AH,v)}function w(){if(AE){g(function(){AE(true)},0)}}return(z={outgoing:function(AI,AJ,AH){AE=AH;AC(AI)},destroy:function(){AF.parentNode.removeChild(AF);AF=null;if(AB){x.parentNode.removeChild(x);x=null}},onDOMReady:function(){AB=y.isHost;AD=0;v=F(y.remote);y.local=X(y.local);if(AB){K.Fn.set(y.channel,function(AI){if(AB&&AI==="ready"){K.Fn.set(y.channel,AG);AA()}});u=l(y.remote,{xdm_e:y.local,xdm_c:y.channel,xdm_p:2});p(y.props,{src:u+"#"+y.channel,name:q+y.channel+"_provider"});x=W(y)}else{y.remoteHelper=y.remote;K.Fn.set(y.channel,AG)}AF=W({props:{src:y.local+"#_4"+y.channel},onLoad:function AH(){var AI=AF||this;T(AI,"load",AH);K.Fn.set(y.channel+"_load",w);(function AJ(){if(typeof AI.contentWindow.sendMessage=="function"){AA()}else{g(AJ,50)}}())}})},init:function(){c(z.onDOMReady,z)}})};K.stack.HashTransport=function(w){var z;var AE=this,AC,x,u,AA,AJ,y,AI;var AD,v;function AH(AL){if(!AI){return }var AK=w.remote+"#"+(AJ++)+"_"+AL;((AC||!AD)?AI.contentWindow:AI).location=AK}function AB(AK){AA=AK;z.up.incoming(AA.substring(AA.indexOf("_")+1),v)}function AG(){if(!y){return }var AK=y.location.href,AM="",AL=AK.indexOf("#");if(AL!=-1){AM=AK.substring(AL)}if(AM&&AM!=AA){AB(AM)}}function AF(){x=setInterval(AG,u)}return(z={outgoing:function(AK,AL){AH(AK)},destroy:function(){j.clearInterval(x);if(AC||!AD){AI.parentNode.removeChild(AI)}AI=null},onDOMReady:function(){AC=w.isHost;u=w.interval;AA="#"+w.channel;AJ=0;AD=w.useParent;v=F(w.remote);if(AC){w.props={src:w.remote,name:q+w.channel+"_provider"};if(AD){w.onLoad=function(){y=j;AF();z.up.callback(true)}}else{var AM=0,AK=w.delay/50;(function AL(){if(++AM>AK){throw new Error("Unable to reference listenerwindow")}try{y=AI.contentWindow.frames[q+w.channel+"_consumer"]}catch(AN){}if(y){AF();z.up.callback(true)}else{g(AL,50)}}())}AI=W(w)}else{y=j;AF();if(AD){AI=parent;z.up.callback(true)}else{p(w,{props:{src:w.remote+"#"+w.channel+new Date(),name:q+w.channel+"_consumer"},onLoad:function(){z.up.callback(true)}});AI=W(w)}}},init:function(){c(z.onDOMReady,z)}})};K.stack.ReliableBehavior=function(v){var x,z;var y=0,u=0,w="";return(x={incoming:function(AC,AA){var AB=AC.indexOf("_"),AD=AC.substring(0,AB).split(",");AC=AC.substring(AB+1);if(AD[0]==y){w="";if(z){z(true)}}if(AC.length>0){x.down.outgoing(AD[1]+","+y+"_"+w,AA);if(u!=AD[1]){u=AD[1];x.up.incoming(AC,AA)}}},outgoing:function(AC,AA,AB){w=AC;z=AB;x.down.outgoing(u+","+(++y)+"_"+AC,AA)}})};K.stack.QueueBehavior=function(w){var z,AA=[],AD=true,x="",AC,u=0,v=false,y=false;function AB(){if(w.remove&&AA.length===0){S(z);return }if(AD||AA.length===0||AC){return }AD=true;var AE=AA.shift();z.down.outgoing(AE.data,AE.origin,function(AF){AD=false;if(AE.callback){g(function(){AE.callback(AF)},0)}AB()})}return(z={init:function(){if(P(w)){w={}}if(w.maxLength){u=w.maxLength;y=true}if(w.lazy){v=true}else{z.down.init()}},callback:function(AF){AD=false;var AE=z.up;AB();AE.callback(AF)},incoming:function(AH,AF){if(y){var AG=AH.indexOf("_"),AE=parseInt(AH.substring(0,AG),10);x+=AH.substring(AG+1);if(AE===0){if(w.encode){x=G(x)}z.up.incoming(x,AF);x=""}}else{z.up.incoming(AH,AF)}},outgoing:function(AI,AF,AH){if(w.encode){AI=d(AI)}var AE=[],AG;if(y){while(AI.length!==0){AG=AI.substring(0,u);AI=AI.substring(AG.length);AE.push(AG)}while((AG=AE.shift())){AA.push({data:AE.length+"_"+AG,origin:AF,callback:AE.length===0?AH:null})}}else{AA.push({data:AI,origin:AF,callback:AH})}if(v){z.down.init()}else{AB()}},destroy:function(){AC=true;z.down.destroy()}})};K.stack.VerifyBehavior=function(y){var z,x,v,w=false;function u(){x=Math.random().toString(16).substring(2);z.down.outgoing(x)}return(z={incoming:function(AC,AA){var AB=AC.indexOf("_");if(AB===-1){if(AC===x){z.up.callback(true)}else{if(!v){v=AC;if(!y.initiate){u()}z.down.outgoing(AC)}}}else{if(AC.substring(0,AB)===v){z.up.incoming(AC.substring(AB+1),AA)}}},outgoing:function(AC,AA,AB){z.down.outgoing(x+"_"+AC,AA,AB)},callback:function(AA){if(y.initiate){u()}}})};K.stack.RpcBehavior=function(AA,v){var x,AC=v.serializer||k();var AB=0,z={};function u(AD){AD.jsonrpc="2.0";x.down.outgoing(AC.stringify(AD))}function y(AD,AF){var AE=Array.prototype.slice;return function(){var AG=arguments.length,AI,AH={method:AF};if(AG>0&&typeof arguments[AG-1]==="function"){if(AG>1&&typeof arguments[AG-2]==="function"){AI={success:arguments[AG-2],error:arguments[AG-1]};AH.params=AE.call(arguments,0,AG-2)}else{AI={success:arguments[AG-1]};AH.params=AE.call(arguments,0,AG-1)}z[""+(++AB)]=AI;AH.id=AB}else{AH.params=AE.call(arguments,0)}if(AD.namedParams&&AH.params.length===1){AH.params=AH.params[0]}u(AH)}}function w(AK,AJ,AF,AI){if(!AF){if(AJ){u({id:AJ,error:{code:-32601,message:"Procedure not found."}})}return }var AH,AE;if(AJ){AH=function(AL){AH=M;u({id:AJ,result:AL})};AE=function(AL,AM){AE=M;var AN={id:AJ,error:{code:-32099,message:AL}};if(AM){AN.error.data=AM}u(AN)}}else{AH=AE=M}if(!N(AI)){AI=[AI]}try{var AD=AF.method.apply(AF.scope,AI.concat([AH,AE]));if(!P(AD)){AH(AD)}}catch(AG){AE(AG.message)}}return(x={incoming:function(AE,AD){var AF=AC.parse(AE);if(AF.method){if(v.handle){v.handle(AF,u)}else{w(AF.method,AF.id,v.local[AF.method],AF.params)}}else{var AG=z[AF.id];if(AF.error){if(AG.error){AG.error(AF.error)}}else{if(AG.success){AG.success(AF.result)}}delete z[AF.id]}},init:function(){if(v.remote){for(var AD in v.remote){if(v.remote.hasOwnProperty(AD)){AA[AD]=y(v.remote[AD],AD)}}}x.down.init()},destroy:function(){for(var AD in v.remote){if(v.remote.hasOwnProperty(AD)&&AA.hasOwnProperty(AD)){delete AA[AD]}}x.down.destroy()}})};B.easyXDM=K})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);var twttr=twttr||{};(function(){var A={};twttr.docHeight=function(){var G=document;return Math.max(G.body.offsetHeight,G.body.clientHeight)};var C=false;var F=0;twttr.autoTune=function(){if(C){return }setTimeout(function(){var G=twttr.docHeight();if(F!==G){F=G;twttr.remote.ui("resizeFrame",G)}twttr.autoTune()},100)};twttr.stopTune=function(){C=true};function E(P){var G=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(G);if(!window.createPopup){G.appendChild(document.createTextNode(""))}var Q=document.styleSheets[document.styleSheets.length-1];for(var K=0,L=P.length;K<L;K++){var J=1,O=P[K],I=O[0],H="";if(Object.prototype.toString.call(O[1][0])==="[object Array]"){O=O[1];J=0}for(var M=O.length;J<M;J++){var N=O[J];H+=N[0]+":"+N[1]+(N[2]?" !important":"")+";\n"}if(Q.insertRule){Q.insertRule(I+"{"+H+"}",Q.cssRules.length)}else{Q.addRule(I,H,-1)}}}function B(){twttr.remote=new easyXDM.Rpc({local:window,onReady:function(){twttr.remote.log("loaded")}},{local:{initialize:function(G){twttr.autoTune();if(G.styles){E(G.styles)}if(window.embedReady){embedReady(G)}},trigger:function(H,K){var J;if(J=A[H]){for(var I=0,G=J.length;I<G;++I){J[I](K)}}}},remote:{log:{},api:{},ui:{}}});twttr.remote.ui.bind=function(H,G){if(!A[H]){A[H]=[]}A[H].push(G);twttr.remote.ui("bind",H)};twttr.remote.ui.unbind=function(G){delete A[G];twttr.remote.ui("unbind",G)}}function D(){if(typeof (window.JSON)=="object"&&window.JSON){return B()}var G=document.createElement("script");G.type="text/javascript";G.async=true;G.onload=G.onerror=B;G.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){this.onreadystatechange=null;B()}};G.src="http://platform.twitter.com/tpane/json2.js";var H=document.getElementsByTagName("head")[0];if(!H){H=document.createElement("head");document.documentElement.appendChild(H)}H.insertBefore(G,H.firstChild)}D()}());